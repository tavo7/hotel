window.$(document).ready(function(){localStorage.clear(),window.routers.base=new Hotel.Routers.Base,window.variables.iddetallecompra=1,window.views.app=new Hotel.Views.App($("body")),window.views.appcaja=new Hotel.Views.AppCaja($("body")),window.collections.detallecompra=new Hotel.Collections.Detallecompra,window.collections.pisos=new Hotel.Collections.Pisos,window.collections.tiposhabitacion=new Hotel.Collections.TiposHabitacion,window.collections.habitaciones=new Hotel.Collections.Habitaciones,window.collections.detallecompra.on("add",function(o){var e=new Hotel.Views.Detallecompra({model:o});e.renderedit(),e.$el.appendTo(".productos-lista")}),window.collections.tiposhabitacion.on("add",function(o){var e=new Hotel.Views.TipoHabitacion({model:o});e.render(),e.$el.appendTo(".tiposhabitacion")}),window.collections.habitaciones.on("add",function(o){var e=new Hotel.Views.Habitacion({model:o});e.render(),e.$el.appendTo(".habitaciones")});var o=window.collections.pisos.fetch();if(o=window.collections.tiposhabitacion.fetch(),o=window.collections.habitaciones.fetch(),window.collections.detallecompra.fetch(),o.done(function(){console.log("Start app"),Backbone.history.start({root:"/caja",pushState:!0,silent:!1})}),$("#productos").length){var e=JSON.parse($("#productos").val());_.each(e,function(o){var e={preciocompra:o.pivot.preciocompra,cantidad:o.pivot.cantidad,cantidadtotal:o.pivot.cantidadtotal,preciototal:o.pivot.preciototal,preciounitario:o.pivot.preciounitario,presentacion:o.pivot.presentacion,producto_id:o.id,unidadmedida:o.pivot.unidadmedida,productonombre:o.nombre};console.log(e);var i=new Hotel.Models.Detallecompra(e);window.collections.detallecompra.add(i),i.save()})}});